
# Cleaned .tmux.conf (John Pazarzis)
# - fixed xterm-keys
# - single set-clipboard
# - removed invalid run-shell path
# - added copy-pipe-and-cancel bind that tries wl-copy, xclip, xsel
# - kept tpm + tmux-yank plugin config

# Unbind default bindings you don't want
unbind r
bind r source-file ~/.tmux.conf

# Default terminal and keys
set -g default-terminal "screen-256color"
set -g xterm-keys on
set -g mouse on

# Prefix: Ctrl + Space
set -g prefix C-Space

# Navigation and common bindings
bind-key L last-window
bind-key -r h select-pane -L
bind-key -r j select-pane -D
bind-key -r k select-pane -U
bind-key -r l select-pane -R

# Open new panes/windows in current directory
bind c new-window -c "#{pane_current_path}"
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# Clipboard handling (tmux >= 2.6 has set-clipboard; behavior improved in newer tmux)
set -g set-clipboard on

# Terminal features (optional - adjust to match your terminal if needed)
# Only required if your terminal advertises a "clipboard" capability you want tmux to use.
# If unsure, you can remove this line.
set -as terminal-features ',xterm-256color:clipboard'

# TPM and plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'

# When using tmux-yank: choose which selection the plugin writes to.
# Options: 'clipboard' (Ctrl-V style), 'primary' (mouse selection), 'secondary'
set -g @yank_selection_mouse 'clipboard'

# Status bar and copy-mode keys
set-option -g status-position top
set-window-option -g mode-keys vi

# Load TPM (ensure ~/.tmux/plugins/tpm exists)
run '~/.tmux/plugins/tpm/tpm'

# Helpful copy binding (vi copy-mode): press 'y' in copy-mode to copy selection to system clipboard.
# This uses a small shell that picks wl-copy (Wayland), then xclip/xsel (X11).
# If you're on macOS, replace the pipe command with "pbcopy".
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "sh -c 'if command -v wl-copy >/dev/null 2>&1; then wl-copy; elif command -v xclip >/dev/null 2>&1; then xclip -selection clipboard -in; elif command -v xsel >/dev/null 2>&1; then xsel -ib; else printf \"no clipboard helper found\\n\" >&2; fi'"

# Keep a modest history limit to avoid slowdowns on pane resize
set -g history-limit 2000
